# 책속에 있는 컨브넷 예제에 대한 설명

#### 4000개의 강아지와 고양이사진으로 구성된 데이터셋에서 강아지와 고양이 이미지 분류하기(이진 분류)
#### 훈련데이터 2000개, 검증데이터 1000개, 테스트데이터 1000개
-----------------------------
### 데이터 내려받기
> 강아지 vs 고양이 데이터셋은 캐글의 https://www.kaggle.com/c/dog-vs-cats/data 에서 내려받을 수 있다.
### 데이터 전처리
```
train_generator = train_datagen.flow_from_directory(
    train_dir, # 타깃 디렉터리
    target_size=(150,150), # 모든 이미지를 150 * 150으로 바꾼다.
    batch_size=20,
    class_mode='binary' # binary_crossentropy 손실함수를 사용하기 때문에 이진 레이블이 필요하다.
)
```
> 이부분의 class_mode 매개 변수의 값은 다중 분류일 때는 'categorical'또는 'spaarse', 이진 분류일 때는 'binary'를 사용한다.
> 'categorical'은 원-핫 인코딩된 2차원 배열을 반환하고 'sparse'는 정수 레이블을 담은 1차원 배열을 반환한다. 'binary'는 0 또는 1로 채워진 1차원 배열을 반환한다. 오토인코더처럼 입력을 타깃으로 하는 경우에는 'input'이라고 지정한다. 참고로 기본값은 'categorical'이다.
### 모델 훈련하기
> 제너레이터를 사용한 데이터에 모델을 훈련시키려면 ```fit_generator```메서드를 쓰는 것을 추천한다. ```fit```메서드와 동일하되 데이터 제너레이터를 사용할 수 있다. 이 메서드는 첫 번째 매개변수로 입력과 타깃의 배치를 끝없이 반환하는 파이썬 제네레이터를 기대한다. 데이터가 끝없이 생성되기 때문에 케라스 모델에 하나의 에포크를 정의하기 위해 제너레이터로부터 얼마나 많은 샘플을 뽑을 것인지 알려주어야 한다. step_per_epoch 매개변수에서 이를 설정한다.
> #### validation_data 매개변수를 전달할 수 있는데, 데이터 제너레이터도 가능하지만 넘파이 배열의 튜플도 가능하다. 제너레이터를 전달하면 검증데이터의 배치를 끝없이 반환하기 때문에 validation_steps 매개변수에 얼마나 많은 배치를 추출할 지 지정해야 한다.
--------------------------------
> ### 데이터 증식
> 과대적합은 학습할 샘플이 너무 적어 새로운 데이터에 일반화할 수 있는 모델을 훈련시킬 수 없기 때문에 발생한다. 무한히 많은 데이터가 주어지면 데이터 분포의 모든 가능한 측면을 모델이 학습할 수 있을 것이다. **데이터 증식**은 기존 훈련 샘플로부터 더 많은 훈련 데이터를 생성하는 방법이다. 이 방법은 그럴듯한 이미지를 생성하도록 여러가지 랜덤한 변환을 적용하여 샘플을 늘린다. 모델이 데이터의 여러 측면을 학습하면 일반화에 도움이 될 것이다.
