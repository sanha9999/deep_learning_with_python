# 뉴스 기사 분류 : 다중 분류 문제

영화 리뷰 분류에서는 신경망을 사용하여 벡터입력을 2개의 클래스로 분류하는지 보았다. 그렇다면 2개 이상의 클래스가 있을때는 어떻게 해야할까?(다중)
---------------------------------------------------------
이 예제에서 로이터 뉴스를 46개의 상호 배타적인 토픽으로 분류하는 신경망을 만들어 본다. 이 문제는 다중 분류의 예이지만, 각 데이터 포인트가 정확히 하나의 범주로 분류되기 때문에 좀 더 정확히 말하면 **단일 레이블 다중 분류** 이다. 각 데이터 포인트가 여러 개의 변주에 속할 수 있다면 그것은 __다중 레이블 다중 분류__ 문제가 된다.

---------------------------------------------------------------
> ### 로이터 데이터셋
> 1986년에 로이터에서 공개한 짧은 뉴스 기사와 토픽의 집합인 **로이터 데이터셋**을 사용한다. 이 데이터 셋은 46개의 토픽이 있으며 각 토픽은 훈련 세트에 최소한 10개의 샘플을 가지고 있다. 
----------------------------------------------------
> ### 모델 구성
>> #### 활성화 함수 softmax
>> 신경망의 출력값에 대하여 마지막 단계에서 출력값을 정규화 해주는 함수이다. 소프트맥스 함수의 결과물의 수치의 합은 항상 1이다. 소프트맥스 함수는 확률적으로 나타내는 것에 용이하다. 
>> #### 손실 함수 categorical_crossentropy
>> 이 함수는 두 확률 분포 사이의 거리를 측정한다. 이 모델에서는 네트워크가 출력한 확률 분포와 진짜 레이블의 분포 사이의 거리이다. 두 분포 사이의 거리가 적어질 수록 정확해지는 것이다.
>> #### .evaluate함수
>> 모델을 평가하는 함수이다.
----------------------------------------------------------
> ### 정리
* N개의 클래스로 데이터 포인트를 분류하려면 네트워크의 마지막 Dense 층의 크기는 N이어야 한다.
* 단일 레이블, 다중 분류 문제에서는 N개의 클래스에 대한 확률 분포를 출력하기 위해 sorfmax 함수를 사용해야 한다.
* 이런 문제에는 항상 범주형 크로스엔트로피(categorical_crossentropy)를 사용한다.
* 다중 분류에서 레이블을 다루는 두가지 방법은
  * 1. 레이블을 범주형 인코딩(or 원-핫 인코딩)으로 인코딩하고 categorical_crossentropy 손실함수를 사용한다.
  * 2. 레이블을 정수로 인코딩하고 sparse_categorical_crossentropy 손실함수를 사용한다.
* 많은 수의 범주를 분류할 때 중간층의 크기가 너무 작아 네트워크에 정보의 병목이 생기지 않도록 해야한다.
